{% macro render_tree(branchHierarchy, branches, prefix="") %}
  {% if branches %}
    <ul class="tree-view">
      {% for branch in branches %}
        <li>
          {{ prefix }}<a href="{{ url('branch_detail', domainId=ddoc.domainId, docId=branch.docId) }}">
            {% if loop.first and not prefix %} 🌳 {% elif branch.subBranches and branch.subBranches|length > 0 %} 🌿 {% else %} 🌱 {% endif %}
            {{ branch.title }}
          </a>

          <!-- 递归渲染子分支 -->
          {% if branch.subBranches and branch.subBranches|length > 0 %}
            {{ render_tree(branchHierarchy, branch.subBranches, prefix + "│  ") }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}
{% endmacro %}

<div class="tree-view">
  {% if branchHierarchy[ddoc.trid] %}
    {{ render_tree(branchHierarchy, branchHierarchy[ddoc.trid]) }}
  {% else %}
    <p>{{ _("No branches available.") }}</p>
  {% endif %}
</div>
