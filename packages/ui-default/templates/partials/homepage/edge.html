{% set edges = payload %}
{% import "components/user.html" as user with context %}
{% if edges and edges.length %}
  <div class="section page--edge_main">
    <div class="section__header">
      <h1 class="section__title">{{ _('Edge') }}</h1>
    </div>
    <ol class="section__list">
      {%- for edge in edges -%}
        {% if edge and edge.eid %}
          {% set currentDomainId = domain._id|default(handler.args.domainId|default('system')) %}
          <li class="section__list__item">
            <div class="media">
              <div class="media__body medium">
                <h1 class="section__item-title">
                  <a href="{{ url('edge_detail', domainId=currentDomainId, eid=edge.eid) }}" data-emoji-enabled>
                    {{ edge.name|default('Edge-' + edge.eid|string) }}
                  </a>
                  {% if edge.status %}
                    <span class="badge badge-{{ 'success' if edge.status == 'online' else ('warning' if edge.status == 'working' else 'secondary') }}">
                      {{ _(edge.status|title) }}
                    </span>
                  {% endif %}
                </h1>
                <ul class="supplementary list">
                  {% if edge.description %}
                    <li>{{ edge.description|truncate(100) }}</li>
                  {% endif %}
                  {% if edge.type %}
                    <li>
                      <span class="icon icon-tag"></span>
                      {{ _('Type') }}: {{ _(edge.type|title) }}
                    </li>
                  {% endif %}
                  {% if edge.toolsCount is defined %}
                    <li>
                      <span class="icon icon-tool"></span>
                      {{ _('Tools') }}: {{ edge.toolsCount|default(0) }}
                    </li>
                  {% endif %}
                  <li>
                    {% if edge.owner and udict[edge.owner] %}
                      {{ user.render_inline(udict[edge.owner]) }}
                    {% elif edge.owner %}
                      {{ _('User') }} #{{ edge.owner }}
                    {% else %}
                      {{ _('Unknown User') }}
                    {% endif %}
                    @
                    {% if edge.updatedAt %}
                      {{ datetimeSpan(edge.updatedAt)|safe }}
                    {% elif edge.createdAt %}
                      {{ datetimeSpan(edge.createdAt)|safe }}
                    {% else %}
                      N/A
                    {% endif %}
                  </li>
                </ul>
              </div>
            </div>
          </li>
        {% endif %}
      {%- endfor -%}
    </ol>
    <ul class="pager pager-bottom"><li>
      <a class="pager__item next link" href="{{ url('edge_domain') }}">{{ _('More') }} ></a>
    </li></ul>
  </div>
{% endif %}

