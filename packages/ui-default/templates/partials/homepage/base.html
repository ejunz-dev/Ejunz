{% set bases = payload %}
{% import "components/user.html" as user with context %}
{% if bases and bases.length %}
  <div class="section page--base_main">
    <div class="section__header">
      <h1 class="section__title">{{ _('Base') }}</h1>
    </div>
    <ol class="section__list">
      {%- for base in bases -%}
        {% if base and base.docId %}
          {% set currentDomainId = domain._id|default(handler.args.domainId|default('system')) %}
          <li class="section__list__item">
            <div class="media">
              <div class="media__body medium">
                <h1 class="section__item-title">
                  <a href="{{ url('base_detail', domainId=currentDomainId, docId=base.docId) }}" data-emoji-enabled>
                    {{ base.title|default('Untitled') }}
                  </a>
                </h1>
              <ul class="supplementary list">
                {% if base.content %}
                  <li>{{ base.content|truncate(100) }}</li>
                {% endif %}
                <li>
                  <span class="icon icon-eye"></span>
                  {{ _('Views') }}: {{ base.views|default(0) }}
                </li>
                <li>
                  <span class="icon icon-nodes"></span>
                  {{ _('Nodes') }}: {{ (base.nodes|length if base.nodes else 0) }}
                </li>
                <li>
                  {% if base.owner and udict[base.owner] %}
                    {{ user.render_inline(udict[base.owner]) }}
                  {% elif base.owner %}
                    {{ _('User') }} #{{ base.owner }}
                  {% else %}
                    {{ _('Unknown User') }}
                  {% endif %}
                  @
                  {% if base.updateAt %}
                    {{ datetimeSpan(base.updateAt)|safe }}
                  {% elif base.createdAt %}
                    {{ datetimeSpan(base.createdAt)|safe }}
                  {% else %}
                    N/A
                  {% endif %}
                </li>
              </ul>
            </div>
          </div>
        </li>
        {% endif %}
      {%- endfor -%}
    </ol>
    <ul class="pager pager-bottom"><li>
      <a class="pager__item next link" href="{{ url('base_domain') }}">{{ _('More') }} ></a>
    </li></ul>
  </div>
{% endif %}

