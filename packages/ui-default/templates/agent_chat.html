{% extends "layout/basic.html" %}
{% block content %}
<div class="row">
  <div class="medium-12 columns">
    <div class="section">
      <div class="section__header">
        <h1 class="section__title">{{ adoc.title }} - {{ _('Chat') }}</h1>
        <div class="section__tools">
          <a href="{{ url('agent_detail', domainId=domainId, aid=adoc.aid) }}" class="button">
            <span class="icon icon-back"></span> {{ _('Back to Agent') }}
          </a>
        </div>
      </div>
      <div class="section__body">
        <div class="mcp-status-container">
          <span id="mcpStatus" class="mcp-status" data-status-url="{{ url('agent_mcp_status', domainId=domainId, aid=adoc.aid) }}">MCP: Checking...</span>
        </div>

        {% if not apiKey or apiKey == '' %}
        <div class="api-key-warning">
          <p>⚠️ {{ _('API Key not configured. Please configure AI settings in system settings') }}</p>
        </div>
        {% endif %}

        <div id="chatContainer" class="chat-container" data-ws-url="{{ wsUrl }}">
          <div class="chat-messages" id="chatMessages"></div>
          <div class="chat-input-container">
            <textarea id="chatInput" placeholder="{{ _('Type your message...') }}" rows="3"></textarea>
            <button id="sendButton" class="button send-button">{{ _('Send') }}</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}


